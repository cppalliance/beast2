#
# Copyright (c) 2023 Vinnie Falco (vinnie.falco@gmail.com)
#
# Distributed under the Boost Software License, Version 1.0. (See accompanying
# file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
#
# Official repository: https://github.com/cppalliance/beast2
#

import testing ;
import ac ;

using openssl ;

project
    : requirements
      $(c11-requires)
      <library>/boost/beast2//boost_beast2
      <library>/boost/beast//boost_beast/<warnings-as-errors>off
      [ ac.check-library /openssl//ssl/<warnings-as-errors>off : <library>/openssl//ssl/<warnings-as-errors>off : ]
      <source>../../../url/extra/test_suite/test_main.cpp
      <source>../../../url/extra/test_suite/test_suite.cpp
      <include>.
      <include>../../../url/extra/test_suite
      <include>../../example/include
      <warnings>extra
      <warnings-as-errors>on
      <target-os>darwin,<undefined-sanitizer>norecover:<link>static
      <target-os>windows:<define>_WIN32_WINNT=0x0601
      <toolset>msvc:<define>_SILENCE_CXX17_ALLOCATOR_VOID_DEPRECATION_WARNING
      <toolset>msvc:<define>_SILENCE_CXX17_ADAPTOR_TYPEDEFS_DEPRECATION_WARNING
      <toolset>msvc:<define>_SILENCE_CXX17_ITERATOR_BASE_CLASS_DEPRECATION_WARNING
    ;

local SOURCES =
    beast.cpp
    buffer.cpp
    client.cpp
    read.cpp
    sandbox.cpp
    write.cpp
    server/fixed_array.cpp
    ;

for local f in $(SOURCES)
{
    run $(f) : : : ;
}
